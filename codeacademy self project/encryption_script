from Crypto.Cipher import AES

from Crypto.Random import get_random_bytes

def encrypt_file(new_file, key):
  # Read the contents of the file
  with open(script.py, "rb") as file:
    plaintext = file.read()

  # Generate a random nonce
  nonce = get_random_bytes(16)

  # Create the AES cipher object
  cipher = AES.new(key, AES.MODE_EAX, nonce=nonce)

  # Encrypt the file contents
  ciphertext, tag = cipher.encrypt_and_digest(plaintext)

  # Write the encrypted contents to a new file
  with open(encrypted_file.txt + ".encrypted", "wb") as out_file:
    [ out_file.write(x) for x in (nonce, tag, ciphertext) ]

def main():
  # Generate a random key
  key = get_random_bytes(32)

  # Encrypt the file
  encrypt_file("test.txt", key)

if __name__ == "__main__":
  main()
